<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="margin:0;padding:0;background-color:#f4f4f7;font-family:Arial,Helvetica,sans-serif;">
<table width="100%" cellpadding="0" cellspacing="0" style="background-color:#f4f4f7;padding:20px 0;">
<tr><td align="center">
<table width="600" cellpadding="0" cellspacing="0" style="background-color:#ffffff;border-radius:8px;overflow:hidden;">

  <!-- Header -->
  <tr>
    <td style="background:linear-gradient(135deg,#1a1a2e,#16213e);padding:30px 40px;text-align:center;">
      <h1 style="color:#ffffff;margin:0;font-size:24px;font-weight:700;">AI News Digest</h1>
      <p style="color:#a0aec0;margin:8px 0 0;font-size:14px;">{{ digest.generated_at.strftime('%B %d, %Y') }} &middot; {{ digest.total_items }} items from {{ digest.sources_checked }} sources</p>
    </td>
  </tr>

  <!-- Executive Summary -->
  <tr>
    <td style="padding:24px 40px 16px;">
      <table width="100%" cellpadding="0" cellspacing="0" style="background-color:#eef2ff;border-left:4px solid #6366f1;border-radius:4px;">
        <tr>
          <td style="padding:16px 20px;">
            <p style="margin:0 0 6px;font-size:13px;font-weight:700;color:#6366f1;text-transform:uppercase;letter-spacing:0.5px;">TL;DR</p>
            <p style="margin:0;font-size:14px;color:#374151;line-height:1.6;">{{ digest.intro_summary }}</p>
          </td>
        </tr>
      </table>
    </td>
  </tr>

  {% for section in digest.sections %}
  <!-- Section: {{ section.title }} -->
  <tr>
    <td style="padding:16px 40px 8px;">
      <h2 style="margin:0;font-size:18px;color:#1a1a2e;border-bottom:2px solid #e5e7eb;padding-bottom:8px;">{{ section.title }}</h2>
    </td>
  </tr>

  {% for item in section.items %}
  <tr>
    <td style="padding:8px 40px;">
      <table width="100%" cellpadding="0" cellspacing="0" style="border:1px solid #e5e7eb;border-radius:6px;overflow:hidden;">
        <tr>
          <td style="padding:14px 16px;">
            <!-- Source badge + title -->
            <p style="margin:0 0 6px;">
              {% if item.source_type.value == 'reddit' %}
              <span style="display:inline-block;background-color:#FF4500;color:#fff;font-size:10px;font-weight:700;padding:2px 8px;border-radius:3px;vertical-align:middle;">REDDIT</span>
              {% elif item.source_type.value == 'youtube' %}
              <span style="display:inline-block;background-color:#FF0000;color:#fff;font-size:10px;font-weight:700;padding:2px 8px;border-radius:3px;vertical-align:middle;">YOUTUBE</span>
              {% elif item.source_type.value == 'github' %}
              <span style="display:inline-block;background-color:#333333;color:#fff;font-size:10px;font-weight:700;padding:2px 8px;border-radius:3px;vertical-align:middle;">GITHUB</span>
              {% else %}
              <span style="display:inline-block;background-color:#1a73e8;color:#fff;font-size:10px;font-weight:700;padding:2px 8px;border-radius:3px;vertical-align:middle;">NEWS</span>
              {% endif %}
              <span style="font-size:11px;color:#6b7280;vertical-align:middle;margin-left:6px;">{{ item.source_name }}</span>
            </p>
            <!-- Title -->
            <a href="{{ item.url }}" style="color:#1a1a2e;font-size:15px;font-weight:600;text-decoration:none;line-height:1.4;">{{ item.title }}</a>
            <!-- Summary -->
            {% if item.summary %}
            <p style="margin:8px 0 0;font-size:13px;color:#4b5563;line-height:1.5;">{{ item.summary }}</p>
            {% endif %}
            <!-- Extra info for GitHub -->
            {% if item.extra.get('stars') %}
            <p style="margin:6px 0 0;font-size:12px;color:#9ca3af;">&#11088; {{ item.extra.stars }} stars{% if item.extra.get('language') %} &middot; {{ item.extra.language }}{% endif %}</p>
            {% endif %}
          </td>
        </tr>
      </table>
    </td>
  </tr>
  {% endfor %}
  {% endfor %}

  {% if project_picks %}
  <!-- Project Recommendations -->
  <tr>
    <td style="padding:24px 40px 16px;">
      <p style="margin:0 0 12px;font-size:13px;font-weight:700;color:#059669;text-transform:uppercase;letter-spacing:0.5px;">Build This</p>
    </td>
  </tr>
  {% for pick in project_picks %}
  <tr>
    <td style="padding:4px 40px;">
      <table width="100%" cellpadding="0" cellspacing="0" style="background-color:#ecfdf5;border-radius:6px;overflow:hidden;">
        <tr>
          <td style="padding:14px 16px;">
            <p style="margin:0 0 4px;">
              <span style="display:inline-block;background-color:#059669;color:#fff;font-size:10px;font-weight:700;padding:2px 8px;border-radius:3px;vertical-align:middle;text-transform:uppercase;">{{ pick.category }}</span>
            </p>
            <a href="{{ pick.url }}" style="color:#1a1a2e;font-size:15px;font-weight:600;text-decoration:none;line-height:1.4;">{{ pick.name }}</a>
            <p style="margin:4px 0 0;font-size:13px;color:#4b5563;line-height:1.5;">{{ pick.description }}</p>
            <p style="margin:4px 0 0;font-size:12px;color:#059669;line-height:1.5;">{{ pick.why }}</p>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  {% endfor %}
  {% endif %}

  <!-- Footer -->
  <tr>
    <td style="padding:24px 40px;text-align:center;border-top:1px solid #e5e7eb;">
      <p style="margin:0;font-size:12px;color:#9ca3af;">Generated by AI News Digest &middot; Summaries by OpenAI</p>
    </td>
  </tr>

</table>
</td></tr>
</table>
</body>
</html>
